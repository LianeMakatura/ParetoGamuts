% Data from http://www.ece.k-state.edu/people/faculty/gjohnson/files/Windbook.pdf
% Chapter 4, figures 8 and 9 (need )
% Data extracted by: https://apps.automeris.io/wpd/

function p = cp_calc(pdegree, plot_bool)
    data = [
        0,0;
        0.1, 0.001;
        0.2, 0.002;
        0.2749371794009572, 0.004328965951540975;
        0.4, 0.006;
        0.6453677832735192, 0.008127548743282365;
        0.9804598895824799, 0.011900453041984338;
        1.2622324392734208, 0.017399318908541794;
        1.6841117381282822, 0.03005881597691379;
        1.9819944852379234, 0.044392917627062656;
        2.138835052365784, 0.05685982599764;
        2.260337121930045, 0.06930105587517804;
        2.3120976271849654, 0.07639749084439446;
        2.3816832863579953, 0.08262452540642334;
        2.4683145737675853, 0.09239335782980052;
        2.537588422667995, 0.10038487169924365;
        2.623751994668655, 0.11280042308374244;
        2.692402223023826, 0.1243208955680144;
        2.778409889888176, 0.1376186866062203;
        2.882086805534327, 0.1509293168909458;
        2.9668472313081966, 0.17128502515880922;
        3.0878815854635273, 0.1863729739974688;
        3.226429283264347, 0.2023560017363552;
        3.3466841117381283, 0.22185514884355073;
        3.5029010583207483, 0.23785101582895676;
        3.676163633139929, 0.2573886806757112;
        3.8505175439132793, 0.27075066794651537;
        4.02424783414139, 0.28764161383214826;
        4.249582724488111, 0.31251123434070466;
        4.475853045652691, 0.33208741692701804;
        4.738553200335042, 0.34551360043042045;
        4.983272295962973, 0.36069142399471754;
        5.3527674690176745, 0.36978344470870195;
        5.687859575326636, 0.3735563490074039;
        6.094720012716968, 0.3712049327162343;
        6.57771412500535, 0.3380264855313919;
        7.06008461674849, 0.30837699696137827;
        6.845091433777, 0.32498547942357897;
        6.380078380543038, 0.35641228654752655;
        7.2570967406655615, 0.29352015456007235;
        7.436595520937141, 0.2777682332585396;
        7.6337635499905225, 0.2620291512035265;
        7.795593081480304, 0.2462643906554741;
        7.939285648779354, 0.23313350982202358;
        8.047639718514805, 0.21997695049553376;
        8.173507131895745, 0.2077154700692708;
        8.299686355549305, 0.19368951033559342;
        8.426177389475486, 0.17789907129450172;
        8.570337672183465, 0.16212147149992967;
        8.696984611245956, 0.1454487928051308;
        8.806118206662957, 0.12788103521010508;
        8.932609240589136, 0.1120905961690134;
        9.005624812760987, 0.0989083583494843;
        9.114446597905369, 0.0831050800618729;
        9.223736098458678, 0.06465508281314009;
        9.29753119631208, 0.04706164672507501;
        9.388995542947278, 0.029481049883529675;
        9.480459889582479, 0.011900453041984338;
        9.75, 0;
        10, 0;
        11, 0;
        12, 0;
        13, 0;
        14, 0;
    ];
    data(:, 1) = 2 * data(:, 1);
    p = polyfit(data(:, 1), data(:, 2), pdegree);

    if plot_bool
        xfine = linspace(0, 30);
        yfine = polyval(p, xfine);
        figure;
        plot(data(:, 1), data(:, 2), 'o');
        hold on
        plot(xfine, yfine);
        hold off
    end
end